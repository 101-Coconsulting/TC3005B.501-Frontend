---
/**
 * Author: Diego Ortega Fernández
 *
 **/

import MainLayout from "@layouts/MainLayout.astro";
import TextHeader from "@components/TextHeader.astro";
import AuthRequestsList from "@/components/RequestsLists/AuthRequestsList";
import TableFallback from "@/components/Table/TableFallback.astro";

import type { UserRole } from "@type/roles";
import { getCookie } from "@data/cookies";
import { roleLabels } from "@config/role-labels";

const role: UserRole = getCookie("role") as UserRole;
const userName = getCookie("username");
const buttonLabel = roleLabels[role];

//FETCH DEMO DATA
//import { duplicateJson } from "@utils/duplicateJson";
///import getuserrequest from '@data/get-user-request.json';

import { apiRequest } from '@utils/apiClient';

const user_id = getCookie("id");
const dept= getCookie("dept");
const requests = await apiRequest(`/user/get-travel-requests/${dept}/4`);


---

<MainLayout title="Comprobaciones pendientes" data={{ userName, buttonLabel, role }}>
  <div>
    {requests && requests.length === 0 ? (
      <TableFallback />
    ) : (
      <TextHeader
        title={"COTIZACIONES DE " + userName.toUpperCase()}
        subtitle="Aquí puedes ver las solicitudes pendientes de cotizar"
      />
      <AuthRequestsList
        client:visible
        data={requests}
        type="cotizar-solicitud"
      />
    )}
    </div>
  </div>
</MainLayout>
